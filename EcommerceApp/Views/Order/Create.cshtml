@model Order
@{
    int quantity = (int)ViewBag.Quantity;
    Product product = ViewBag.Product;
    string status = "Pending...";
}
<div class="row">
    <!-- First column -->
    <div class="col-12 col-md-4 border rounded mt-2">
        <div class="row border-bottom">
            <div class="col">
                <h4>Dane odbiorcy do przesyłki</h4>
            </div>
        </div>
        <form asp-action="CreateOrder" method="post">
            <div class="form-group mt-3">
                <label asp-for="UserName">Imie i nazwisko</label>
                <input type="text" class="form-control" asp-for="UserName" />
                <span asp-validation-for="UserName" class="text-danger"></span>
            </div>
            <div class="form-group mt-3">
                <label asp-for="ShippingAddress">Adres dostawy</label>
                <input type="text" class="form-control" asp-for="ShippingAddress" />
                <span asp-validation-for="ShippingAddress" class="text-danger"></span>
            </div>
            <div class="form-group mt-3">
                <label asp-for="PostalCode">Kod pocztowy i miasto</label>
                <input type="text" class="form-control" asp-for="PostalCode" />
                <span asp-validation-for="PostalCode" class="text-danger"></span>
            </div>
            <div class="form-group mt-3">
                <label asp-for="PhoneNumber">Numer telefonu</label>
                <input type="text" class="form-control" asp-for="PhoneNumber" />
                <span asp-validation-for="PhoneNumber" class="text-danger"></span>
            </div>
            <div class="form-group mt-3">
                <label asp-for="PaymentMethod">Metoda płatności</label>
                <input type="text" class="form-control" asp-for="PaymentMethod" />
                <span asp-validation-for="PaymentMethod" class="text-danger"></span>
            </div>

            <input type="hidden" asp-for="UserId" asp-value="@ViewBag.UserId" />
            <input type="hidden" asp-for="User" asp-value="@ViewBag.User" />
            <input type="hidden" asp-for="Status" asp-value="@status" />
            @*method arguments*@
            <input type="hidden" name="price" value="@(product.Price + 9.99M)" />
            <input type="hidden" name="quantity" value="@quantity" />
            <input type="hidden" name="productId" value="@product.Id" />
            <button type="submit" class="btn btn-primary mt-3">Create Order</button>
        </form>

        <div class="row mt-3">
            <div class="col">
                <h3 class="border-bottom">Sposób dostawy: TODO</h3>
                <div id="map" style="height:400px; width:100%;"></div>

                <script src="https://cdn.jsdelivr.net/npm/leaflet@1.7.1/dist/leaflet.js"></script>
                <script>
                    var map = L.map('map').setView([52.2297, 21.0122], 13);

                    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors',
                        maxZoom: 18,
                    }).addTo(map);

                    var apiUrl = 'https://api.paczkomaty.pl/v1/pickup-points?latitude=52.2297&longitude=21.0122';
                    fetch(apiUrl)
                        .then(function (response) {
                            return response.json();
                        })
                        .then(function (data) {
                            data.pickupPoints.forEach(function (pickupPoint) {
                                var marker = L.marker([pickupPoint.latitude, pickupPoint.longitude]).addTo(map);
                                marker.bindPopup('<b>' + pickupPoint.name + '</b><br/>' + pickupPoint.address.full);
                            });
                        })
                        .catch(function (error) {
                            console.log('Wystąpił błąd:', error);
                        });
                </script>
            </div>
        </div>
        <div class="row mt-3">
            <div class="col">
                <p>Wpisz swój kupon:</p>
                <textarea class="form-control"></textarea>
            </div>
        </div>
    </div>
    <!-- Second Column -->
    <div class="col-6 offset-md-1 col-md-2 rounded-circle mt-2">
        <div class="card" style="width: 18rem;">
            <div class="card-header">
                Podsumowanie produktu
            </div>
            <img class="card-img-top img-thumbnail" src="@product.ImageUrl" alt="@product.Name">
            <div class="card-body">
                <h5 class="card-title">@product.Name</h5>
                <p class="card-text">Lorem ipsum</p>
            </div>
            <ul class="list-group list-group-flush">
                <li class="list-group-item"><b>Cena: </b>@product.Price</li>
                <li class="list-group-item"><b>Kolor: </b>@product.Color</li>
                <li class="list-group-item"><b>Wymiary: </b>@product.Length x @product.Height x @product.Width</li>
                <li class="list-group-item"><b>Waga: </b>@product.Weight</li>
            </ul>
            <div class="card-body">
                <button class="button btn-warning">Strona Główna</button>
            </div>
        </div>
    </div>
    <!-- Third Column -->
    <div class="col-6 col-md-4 offset-md-1 mt-2">
        <div class="row border-bottom text-left mb-3">
            <h5>Podsumowanie</h5>
        </div>
        <div class="row border-bottom mb-3">
            <div class="col">
                <div class="row">
                    <span class="font-weight-bold">Wartość produktów</span>
                </div>
                <div class="row">
                    <span class="font-weight-bold">Dostawa</span>
                </div>
            </div>
            <div class="col">
                <div class="row">
                    @product.Price zł
                </div>
                <div class="row">
                    9.99 zł
                </div>
            </div>
        </div>
        <div class="row mb-3">
            <div class="col">
                <h4><span class="font-weight-bold">Razem: </span>@(product.Price + 9.99M)</h4>
            </div>
        </div>
        <div class="row mb-3">
            <div class="col-12">
                <button class="btn btn-primary btn-block">Zapłać teraz</button>
            </div>
        </div>
        <div class="row">
            <div class="col-12 col-md-12">
                <small class="text-muted">W następnym kroku zostaniesz przekierowany na stronę bankową, by zapłacić za swoje zakupy.</small>
            </div>
        </div>
    </div>

</div>
